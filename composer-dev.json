{
	"name": "greenpeace/planet4-base",
	"version": "0.3.0",

	"repositories": [
		{
			"type": "composer",
			"url": "https://p4-composer-registry.greenpeace.org/"
		},
		{
			"type": "composer",
			"url": "https://wpackagist.org"
		},
		{
			"type": "vcs",
			"url": "https://github.com/greenpeace/planet4-wordpress"
		},
		{
			"type": "vcs",
			"url": "https://github.com/greenpeace/planet4-master-theme"
		},
		{
			"type": "vcs",
			"url": "https://github.com/greenpeace/planet4-child-theme"
		},
		{
			"type": "vcs",
			"url": "https://github.com/greenpeace/planet4-content-default"
		},
		{
			"type": "vcs",
			"url": "https://github.com/greenpeace/planet4-plugin-engagingnetworks"
		},
		{
			"type": "vcs",
			"url": "https://github.com/greenpeace/planet4-plugin-action-content-type"
		}

	],

	"require": {
		"composer/installers": "~1.0",
		"wp-cli/wp-cli": "^1.1",
		"greenpeace/planet4-wordpress": "4.8.1",
		"greenpeace/planet4-master-theme" : "dev-develop",
		"greenpeace/planet4-child-theme" : "dev-develop",
		"greenpeace/planet4-content-default": "dev-develop",
		"greenpeace/planet4-plugin-engagingnetworks" : "dev-develop",
		"greenpeace/planet4-plugin-action-content-type" : "dev-develop"
	},

	"config": {
		"secure-http": false,
		"github-protocols": ["https"]
	},

	"extra": {
		"installer-paths": {
			"vendor/plugins/{$name}/": ["type:wordpress-plugin"],
			"vendor/themes/{$name}/": ["type:wordpress-theme"]
		}
	},

	"scripts": {
		"site-install": [
			"@copy:wordpress",
			"@reset:themes", "@reset:plugins", "@copy:themes", "@copy:assets", "@copy:plugins",
			"@core:install", "@plugin:activate", "@theme:activate",
			"@core:initial-content"
		],

		"site-update": [
			"@copy:wordpress",
			"@reset:themes", "@reset:plugins", "@copy:themes", "@copy:assets", "@copy:plugins",
			"@core:updatedb", "@core:updatedb", "@plugin:deactivate", "@plugin:activate", "@theme:activate"
		],

		"site-dev": [
			"@core:add-super-admin-user"
		],

		"docker-site-install": [
			"@copy:wordpress",
			"@reset:themes", "@copy:themes", "@copy:assets", "@copy:plugins",
			"@core:config", "@core:install", "@plugin:activate", "@theme:activate",
			"@core:initial-content"
		],

		"theme:install": ["@copy:theme", "@theme:activate"],
		"plugin:install": ["@copy:plugin", "@plugin:activate"],

		"reset:public" : "$(rm -rf public; rm -fr public/*; rm -fr public/.*; mkdir public || true)",
		"reset:themes" : "rm -rf public/wp-content/themes",
		"reset:plugins" : "rm -rf public/wp-content/plugins",

		"copy:wordpress": "rsync -r vendor/greenpeace/planet4-wordpress-upstream/* public",
		"copy:plugins" : "rsync -r vendor/plugins public/wp-content",
		"copy:themes" : "rsync -r vendor/themes public/wp-content",
		"copy:assets" : "rsync -r vendor/greenpeace/planet4-content-default/assets public/wp-content/themes/planet4-master-theme",

		"core:config": "wp core config --skip-check --force",
		"core:install": "wp core install",
		"core:updatedb": "wp core update-db",
		"core:initial-content": "composer run-script content-default -d vendor/greenpeace/planet4-content-default ",
		"core:add-super-admin-user": "wp user create dev p4-dev@greenpeace.org --role=administrator --user_pass=u3vsREsvjwo",

		"plugin:deactivate": "wp plugin deactivate --all",
		"plugin:activate": "wp plugin activate --all",
		"theme:activate": "wp theme activate",

		"server": "php -S 127.0.0.1:9191 -t public"
	}
}
